function e(e,t,o,c){Object.defineProperty(e,t,{get:o,set:c,enumerable:!0,configurable:!0})}var t={};e(t,"refreshUpperBound",(()=>ee)),e(t,"neighbors",(()=>K)),e(t,"draw",(()=>X)),e(t,"update",(()=>Z)),e(t,"init",(()=>W)),e(t,"getActive",(()=>te)),e(t,"getUpperBound",(()=>_));var o={};e(o,"make",(()=>U)),e(o,"update",(()=>O)),e(o,"NAME",(()=>D));const c=()=>({type:"EMPTY",clock:0});var i={};e(i,"NAME",(()=>x)),e(i,"make",(()=>N)),e(i,"update",(()=>B));const r=(...e)=>Math.round(((e,t=0)=>Math.random()*(e-t)+t)(...e)),n=e=>e[r(e.length-1,0)],s=e=>Math.random()<e,a=({type:e,color:t,...o})=>({type:e,clock:0,colorInput:t,color:l(t),...o}),l=e=>`hsl(${e[0]}deg ${e[1]}% ${r(e[2],e[3])}%)`,d=e=>{e.color=l(e.colorInput)};var p={};e(p,"make",(()=>L)),e(p,"NAME",(()=>P)),e(p,"update",(()=>q));var y={};e(y,"NAME",(()=>E)),e(y,"make",(()=>k));const E="WOOD",k=()=>a({type:E,color:[33,41,30,15]});var m={};e(m,"make",(()=>v)),e(m,"NAME",(()=>u)),e(m,"update",(()=>M));const u="SMOKE",v=()=>a({type:u,direction:n([1,-1]),color:[4,2,79,90]}),M=(e,t)=>{const o=e.get(0,-1);switch(s(.015)&&e.set(0,0,{type:"EMPTY",clock:0}),o.type){case"EMPTY":s(.95)?e.move(0,-1):e.is(t.direction,1,"EMPTY")&&e.move(t.direction,-1);break;case x:e.move(0,-1)}s(.5)&&e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):t.direction*=-1};var f={};e(f,"update",(()=>w)),e(f,"NAME",(()=>h)),e(f,"make",(()=>b));const h="OIL",b=()=>a({type:h,direction:n([1,-1]),color:[25,59,41,48]}),w=(e,t)=>{switch(e.get(0,1).type){case P:case"EMPTY":e.move(0,1);break;case h:e.is(t.direction,1,"EMPTY")&&e.move(t.direction,1);break;case x:e.is(t.direction,-1,x)&&e.swap(t.direction,-1)}e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):s(.5)&&e.is(t.direction,0,x)?e.swap(t.direction,0):t.direction*=-1,s(.005)&&d(t)},P="FIRE",T=[35,76,62,72],Y=[35,79,67,77],g=[7,82,56,66],S=[7,82,49,59],A=[7,87,33,43],L=(e="spark")=>a({type:P,phase:e,direction:n([1,-1]),color:n([T,Y,g,S,A])}),q=(e,t)=>{switch(t.phase){case"spark":s(.2)&&e.set(0,0,{type:"EMPTY",clock:0}),s(.73)&&e.is(0,-1,"EMPTY")?e.move(0,-1):e.is(t.direction,-1,"EMPTY")&&e.move(t.direction,-1),s(.75)&&e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):t.direction*=-1,(e=>{let t;for(let[o,c]of e.neighbors(1))if(s(1)&&(e.is(o,c,E)||e.is(o,c,h))){t=[o,c];break}t&&(e.set(...t,L("blaze")),e.set(0,0,{type:"EMPTY",clock:0}))})(e);break;case"blaze":if(((e,t)=>{let o;for(let[c,i]of e.neighbors(2))if(s(t)&&(e.is(c,i,E)||e.is(c,i,h))){o=[c,i];break}o&&e.set(...o,L("blaze"))})(e,.01),s(.01))return void e.set(0,0,v());e.is(0,-1,"EMPTY")&&(s(.06)?e.set(0,-1,L()):s(.15)&&e.set(0,-1,v()));let o=!0;for(let[t,c]of e.neighbors(1))if(!e.is(t,c,"EMPTY")){o=!1;break}o&&e.set(0,0,{type:"EMPTY",clock:0})}},x="WATER",N=()=>a({type:x,direction:n([1,-1]),color:[216,65,60,50]}),B=(e,t)=>{switch(e.get(0,1).type){case P:case"EMPTY":e.move(0,1);break;case h:e.swap(0,1);break;case x:e.is(t.direction,1,"EMPTY")&&e.move(t.direction,1)}e.is(t.direction,0,"EMPTY")||e.is(t.direction,0,P)?e.move(t.direction,0):t.direction*=-1,s(.005)&&d(t)},D="SAND",U=()=>a({type:D,color:[46,78,75,50]}),O=e=>{const t=e.get(0,1),o=n([1,-1]);switch(t.type){case"EMPTY":e.move(0,1);break;case h:case x:e.swap(0,1);break;case D:e.is(o,1,"EMPTY")&&e.move(o,1)}};let R,I,z,G,$=[],F=0;const W=(e=100)=>{R=1,z={x:0,y:e},I=z,F=e,$=Array.from({length:F*F},(()=>({type:"EMPTY",clock:0})))},j=(e,t)=>e<0||t<0||e>=F||t>=F?{type:"BOUNDS"}:$[Q(e,t)],C=(e,t,o={type:"EMPTY",clock:0})=>{const c=Q(e,t);o.clock=R+1,$[c]=o,t<I.y&&(I={x:e,y:t})},K=(e=1)=>Array.from({length:e},((e,t)=>{const o=t+1;return[[-1*o,-1*o],[-1*o,0],[-1*o,1*o],[0,-1*o],[0,1*o],[1*o,-1*o],[1*o,0],[1*o,1*o]]})).flat(),H=(e,t)=>({is:(o,c,i)=>j(e+o,t+c).type===i,move:(o,c)=>{const i=j(e,t);i.clock>R||(C(e+o,t+c,i),C(e,t,{type:"EMPTY",clock:0}))},swap:(o,c)=>{const i=j(e,t);if(i.clock>R)return;const r=e+o,n=t+c,s=j(r,n);C(r,n,i),C(e,t,s)},set:(o,c,i)=>C(e+o,t+c,i),get:(o,c)=>j(e+o,t+c),neighbors:K}),J=H(0,0),Q=(e,t)=>e*F+t,V=e=>{const t=e%F;return[(e-t)/F,t]},X=(e,t,o)=>{if("EMPTY"===o.type||J.is(e,t,"EMPTY")){const c=Q(e,t);o.clock=R,$[c]=o,t<I.y&&(I={x:e,y:t})}},Z=()=>{G={};for(let e=0,t=$.length;e<t;e++){const[t,o]=V(e),c=$[e];"EMPTY"!==c.type&&(c.color in G?G[c.color].push({x:t,y:o,cell:c}):G[c.color]=[{x:t,y:o,cell:c}]);const i=H(t,o);switch(c.type){case D:O(i,c);break;case x:B(i,c);break;case u:M(i,c);break;case P:q(i,c);break;case h:w(i,c)}}R++},_=()=>I.y,ee=()=>{J.is(I.x,I.y,"EMPTY")&&(I=z)},te=()=>G,oe=document.querySelector("canvas"),ce=oe.getContext("2d",{alpha:!1}),ie=window.devicePixelRatio||1;oe.width=500*ie,oe.height=500*ie,oe.style.width="500px",oe.style.height="500px",ce.scale(ie,ie),ce.fillStyle="white",ce.fillRect(0,0,500,500);var re={};e(re,"make",(()=>se)),e(re,"NAME",(()=>ne));const ne="STONE",se=()=>a({type:ne,color:[0,0,60,40]});window.DEBUG=!1;let ae,le,de,pe;const ye=()=>{t.update(),(e=>{const t=5*e.getUpperBound()-5;ce.fillStyle="white",ce.fillRect(0,t,500,500-t),window.DEBUG&&(ce.fillStyle="red",ce.fillRect(0,t,500,1));const o=e.getActive();for(let e in o){ce.fillStyle=e;const t=o[e];for(let{x:e,y:o}of t)ce.fillRect(5*e,5*o,5,5)}e.refreshUpperBound()})(t)},Ee=()=>{requestAnimationFrame(Ee),ae=Date.now(),le=ae-de,le>pe&&(de=ae-le%pe,ye())},ke=document.querySelector("#canvas");let me=!1;const ue=e=>Math.floor(e/5),ve=e=>{(e=>{const t=ue(e.x),o=ue(e.y);return[[t,o],[t+1,o],[t-1,o],[t,o+1],[t,o-1]]})(e).forEach((e=>t.draw(...e,Ae())))};ke.addEventListener("mousemove",(e=>{me&&ve(e)})),ke.addEventListener("click",ve),ke.addEventListener("mousedown",(()=>{me=!0})),ke.addEventListener("mouseup",(()=>{me=!1}));let Me="sand";const fe=document.querySelector("#pedra-btn"),he=document.querySelector("#areia-btn"),be=document.querySelector("#ar-btn"),we=document.querySelector("#water-btn"),Pe=document.querySelector("#smoke-btn"),Te=document.querySelector("#wood-btn"),Ye=document.querySelector("#fire-btn"),ge=document.querySelector("#oil-btn"),Se={sand:o,stone:re,empty:{make:c},water:i,smoke:m,wood:y,fire:p,oil:f},Ae=()=>Se[Me].make();fe.addEventListener("click",(()=>Me="stone")),he.addEventListener("click",(()=>Me="sand")),be.addEventListener("click",(()=>Me="empty")),we.addEventListener("click",(()=>Me="water")),Pe.addEventListener("click",(()=>Me="smoke")),Te.addEventListener("click",(()=>Me="wood")),Ye.addEventListener("click",(()=>Me="fire")),ge.addEventListener("click",(()=>Me="oil")),document.querySelector("#tick").addEventListener("click",ye),t.init(),window.DEBUG||(pe=1e3/60,de=Date.now(),Ee());
//# sourceMappingURL=index.d618a063.js.map
