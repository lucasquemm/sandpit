{"mappings":"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","sources":["src/elements/empty.js","src/random.js","src/element.js","src/elements/wood.js","src/elements/smoke.js","src/elements/oil.js","src/elements/plant.js","src/elements/fire.js","src/elements/water.js","src/elements/sand.js","src/sandpit.js","src/canvas.js","src/elements/stone.js","src/main.js"],"sourcesContent":["const EMPTY = 'EMPTY'\nconst empty = () => ({ type: EMPTY, clock: 0 })\n\nexport { EMPTY, empty }\n","const rand = (max, min = 0) => Math.random() * (max - min) + min\nconst randInt = (...args) => Math.round(rand(...args))\nconst pickRand = (values) => values[randInt(values.length - 1, 0)]\nconst chance = (threshold) => Math.random() < threshold\n\nexport { rand, randInt, pickRand, chance }\n","import { randInt } from './random'\n\nconst make = ({ type, color, ...meta }) => ({\n  type,\n  clock: 0,\n  colorInput: color,\n  color: createColor(color),\n  ...meta,\n})\n\nconst createColor = (color) =>\n  `hsl(${color[0]}deg ${color[1]}% ${randInt(color[2], color[3])}%)`\n\nconst updateColor = (cell) => {\n  cell.color = createColor(cell.colorInput)\n}\n\nexport { make, updateColor }\n","import * as element from '../element'\n\nconst NAME = 'WOOD'\n\nconst make = () => element.make({ type: NAME, color: [33, 41, 30, 15] })\n\nexport { NAME, make }\n","import * as water from './water'\nimport { EMPTY, empty } from './empty'\nimport * as element from '../element'\nimport { chance, pickRand } from '../random'\n\nconst NAME = 'SMOKE'\nconst despawnChance = 0.015\nconst chanceOfGoingStraight = 0.95\nconst chanceOfSpread = 0.5\n\nconst make = () =>\n  element.make({\n    type: NAME,\n    direction: pickRand([1, -1]),\n    color: [4, 2, 79, 90],\n  })\n\nconst update = (sandpit, cell) => {\n  const above = sandpit.get(0, -1)\n\n  if (chance(despawnChance)) {\n    sandpit.set(0, 0, empty())\n  }\n\n  switch (above.type) {\n    case EMPTY:\n      if (chance(chanceOfGoingStraight)) {\n        sandpit.move(0, -1)\n      } else if (sandpit.is(cell.direction, 1, EMPTY)) {\n        sandpit.move(cell.direction, -1)\n      }\n      break\n    case water.NAME:\n      sandpit.move(0, -1)\n      break\n  }\n\n  if (chance(chanceOfSpread) && sandpit.is(cell.direction, 0, EMPTY)) {\n    sandpit.move(cell.direction, 0)\n  } else {\n    cell.direction *= -1\n  }\n}\n\nexport { NAME, make, update }\n","import { EMPTY } from './empty'\nimport * as element from '../element'\nimport * as fire from './fire'\nimport * as water from './water'\nimport { chance, pickRand } from '../random'\n\nconst NAME = 'OIL'\n\nconst make = () =>\n  element.make({\n    type: NAME,\n    direction: pickRand([1, -1]),\n    color: [25, 59, 41, 48],\n  })\n\nconst update = (sandpit, cell) => {\n  const below = sandpit.get(0, 1)\n\n  switch (below.type) {\n    case fire.NAME:\n    case EMPTY:\n      sandpit.move(0, 1)\n      break\n    case NAME:\n      if (sandpit.is(cell.direction, 1, EMPTY)) {\n        sandpit.move(cell.direction, 1)\n      }\n      break\n    case water.NAME:\n      if (sandpit.is(cell.direction, -1, water.NAME)) {\n        sandpit.swap(cell.direction, -1)\n      }\n      break\n  }\n\n  if (sandpit.is(cell.direction, 0, EMPTY)) {\n    sandpit.move(cell.direction, 0)\n  } else if (chance(0.5) && sandpit.is(cell.direction, 0, water.NAME)) {\n    sandpit.swap(cell.direction, 0)\n  } else {\n    cell.direction *= -1\n  }\n\n  if (chance(0.005)) {\n    element.updateColor(cell)\n  }\n}\n\nexport { NAME, make, update }\n","import { empty, EMPTY } from './empty'\nimport * as water from './water'\nimport * as element from '../element'\nimport { chance, pickRand, randInt } from '../random'\n\nconst NAME = 'PLANT'\n\nconst make = (energy = randInt(10, 20)) =>\n  element.make({\n    type: NAME,\n    energy,\n    direction: [pickRand([1, -1]), pickRand([1, -1])],\n    color: [122, 73, 36, 30],\n  })\n\nconst update = (sandpit, cell) => {\n  const [dx, dy] = cell.direction\n\n  if (sandpit.is(dx, dy, EMPTY)) {\n    if (chance(0.2) && cell.energy > 0) {\n      cell.energy--\n      sandpit.set(dx, dy, make(cell.energy))\n    }\n  }\n\n  for (let [nx, ny] of sandpit.neighbors(1)) {\n    if (chance(0.05) && sandpit.is(nx, ny, water.NAME)) {\n      sandpit.set(nx, ny, empty())\n      sandpit.set(dx, dy, make(cell.energy))\n    }\n  }\n}\n\nexport { NAME, make, update }\n","import { EMPTY, empty } from './empty'\nimport * as wood from './wood'\nimport * as smoke from './smoke'\nimport * as oil from './oil'\nimport * as plant from './plant'\nimport * as element from '../element'\nimport { chance, pickRand } from '../random'\n\nconst NAME = 'FIRE'\nconst despawnChance = 0.2\nconst chanceOfGoingStraight = 0.73\nconst chanceOfSpread = 0.75\nconst ignitingChance = 1\nconst burningChance = 0.01\n\nconst extinguishChance = 0.01\nconst looseFlameChance = 0.06\n\nconst orange1 = [35, 76, 62, 72]\nconst orange2 = [35, 79, 67, 77]\nconst red1 = [7, 82, 56, 66]\nconst red2 = [7, 82, 49, 59]\nconst red3 = [7, 87, 33, 43]\n\nconst make = (phase = 'spark') =>\n  element.make({\n    type: NAME,\n    phase,\n    direction: pickRand([1, -1]),\n    color: pickRand([orange1, orange2, red1, red2, red3]),\n  })\n\nconst ignite = (sandpit) => {\n  let igniteTarget\n\n  for (let [nx, ny] of sandpit.neighbors(1)) {\n    if (\n      chance(ignitingChance) &&\n      (sandpit.is(nx, ny, wood.NAME) ||\n        sandpit.is(nx, ny, oil.NAME) ||\n        sandpit.is(nx, ny, plant.NAME))\n    ) {\n      igniteTarget = [nx, ny]\n      break\n    }\n  }\n\n  if (igniteTarget) {\n    sandpit.set(...igniteTarget, make('blaze'))\n    sandpit.set(0, 0, empty())\n  }\n}\n\nconst burn = (sandpit, spreadChance) => {\n  let burnTarget\n\n  for (let [nx, ny] of sandpit.neighbors(2)) {\n    if (\n      chance(spreadChance) &&\n      (sandpit.is(nx, ny, wood.NAME) ||\n        sandpit.is(nx, ny, oil.NAME) ||\n        sandpit.is(nx, ny, plant.NAME))\n    ) {\n      burnTarget = [nx, ny]\n      break\n    }\n  }\n  if (burnTarget) sandpit.set(...burnTarget, make('blaze'))\n}\n\nconst update = (sandpit, cell) => {\n  switch (cell.phase) {\n    case 'spark':\n      if (chance(despawnChance)) {\n        sandpit.set(0, 0, empty())\n      }\n\n      if (chance(chanceOfGoingStraight) && sandpit.is(0, -1, EMPTY)) {\n        sandpit.move(0, -1)\n      } else if (sandpit.is(cell.direction, -1, EMPTY)) {\n        sandpit.move(cell.direction, -1)\n      }\n\n      if (chance(chanceOfSpread) && sandpit.is(cell.direction, 0, EMPTY)) {\n        sandpit.move(cell.direction, 0)\n      } else {\n        cell.direction *= -1\n      }\n\n      ignite(sandpit)\n      break\n    case 'blaze':\n      burn(sandpit, burningChance)\n\n      if (chance(extinguishChance)) {\n        sandpit.set(0, 0, smoke.make())\n        return\n      } else if (sandpit.is(0, -1, EMPTY)) {\n        if (chance(looseFlameChance)) {\n          sandpit.set(0, -1, make())\n        } else if (chance(0.15)) {\n          sandpit.set(0, -1, smoke.make())\n        }\n      }\n\n      let noNeighbors = true\n\n      for (let [nx, ny] of sandpit.neighbors(1)) {\n        if (!sandpit.is(nx, ny, EMPTY)) {\n          noNeighbors = false\n          break\n        }\n      }\n      if (noNeighbors) {\n        sandpit.set(0, 0, empty())\n      }\n      break\n  }\n}\n\nexport { NAME, make, update }\n","import { EMPTY } from './empty'\nimport * as element from '../element'\nimport * as fire from './fire'\nimport * as oil from './oil'\nimport { chance, pickRand } from '../random'\n\nconst NAME = 'WATER'\n\nconst make = () =>\n  element.make({\n    type: NAME,\n    direction: pickRand([1, -1]),\n    color: [216, 65, 60, 50],\n  })\n\nconst update = (sandpit, cell) => {\n  const below = sandpit.get(0, 1)\n\n  switch (below.type) {\n    case fire.NAME:\n    case EMPTY:\n      sandpit.move(0, 1)\n      break\n    case oil.NAME:\n      sandpit.swap(0, 1)\n      break\n    case NAME:\n      if (sandpit.is(cell.direction, 1, EMPTY)) {\n        sandpit.move(cell.direction, 1)\n      }\n      break\n  }\n\n  if (\n    sandpit.is(cell.direction, 0, EMPTY) ||\n    sandpit.is(cell.direction, 0, fire.NAME)\n  ) {\n    sandpit.move(cell.direction, 0)\n  } else {\n    cell.direction *= -1\n  }\n\n  if (chance(0.005)) {\n    element.updateColor(cell)\n  }\n}\n\nexport { NAME, make, update }\n","import { EMPTY } from './empty'\nimport * as water from './water'\nimport * as oil from './oil'\nimport * as element from '../element'\nimport { pickRand } from '../random'\n\nconst NAME = 'SAND'\n\nconst make = () => element.make({ type: NAME, color: [46, 78, 75, 50] })\n\nconst update = (sandpit) => {\n  const below = sandpit.get(0, 1)\n  const direction = pickRand([1, -1])\n\n  switch (below.type) {\n    case EMPTY:\n      sandpit.move(0, 1)\n      break\n    case oil.NAME:\n    case water.NAME:\n      sandpit.swap(0, 1)\n      break\n    case NAME:\n      if (sandpit.is(direction, 1, EMPTY)) {\n        sandpit.move(direction, 1)\n      }\n      break\n  }\n}\n\nexport { NAME, make, update }\n","import * as sand from './elements/sand'\nimport { empty, EMPTY } from './elements/empty'\nimport * as water from './elements/water'\nimport * as smoke from './elements/smoke'\nimport * as fire from './elements/fire'\nimport * as oil from './elements/oil'\nimport * as plant from './elements/plant'\n\nlet cells = []\nlet size = 0\nlet generation\nlet upperBound\nlet defaultUpperBound\nlet activeCells\n\nconst init = (newSize = 100) => {\n  generation = 1\n  defaultUpperBound = { x: 0, y: newSize }\n  upperBound = defaultUpperBound\n  size = newSize\n  cells = Array.from({ length: size * size }, () => empty())\n}\nconst get = (x, y) => {\n  if (x < 0 || y < 0 || x >= size || y >= size) return { type: 'BOUNDS' }\n\n  return cells[getIndex(x, y)]\n}\n\nconst set = (x, y, cell = empty()) => {\n  const index = getIndex(x, y)\n\n  cell.clock = generation + 1\n  cells[index] = cell\n\n  if (y < upperBound.y) upperBound = { x, y }\n}\n\nconst neighbors = (range = 1) => {\n  return Array.from({ length: range }, (_, i) => {\n    const n = i + 1\n    return [\n      [n * -1, n * -1],\n      [n * -1, 0],\n      [n * -1, n * 1],\n      [0, n * -1],\n      [0, n * 1],\n      [n * 1, n * -1],\n      [n * 1, 0],\n      [n * 1, n * 1],\n    ]\n  }).flat()\n}\n\nconst createApi = (cx, cy) => {\n  const relativeGet = (dx, dy) => get(cx + dx, cy + dy)\n  const relativeSet = (dx, dy, cell) => set(cx + dx, cy + dy, cell)\n\n  const is = (dx, dy, type) => get(cx + dx, cy + dy).type === type\n\n  const move = (dx, dy) => {\n    const cell = get(cx, cy)\n\n    if (cell.clock > generation) return\n\n    set(cx + dx, cy + dy, cell)\n    set(cx, cy, empty())\n  }\n\n  const swap = (dx, dy) => {\n    const c0 = get(cx, cy)\n\n    if (c0.clock > generation) return\n\n    const x = cx + dx\n    const y = cy + dy\n    const c1 = get(x, y)\n\n    set(x, y, c0)\n    set(cx, cy, c1)\n  }\n\n  return { is, move, swap, set: relativeSet, get: relativeGet, neighbors }\n}\n\nconst self = createApi(0, 0)\n\nconst getIndex = (x, y) => x * size + y\n\nconst getCoords = (index) => {\n  const y = index % size\n  const x = (index - y) / size\n\n  return [x, y]\n}\n\nconst draw = (x, y, cell) => {\n  if (cell.type === EMPTY || self.is(x, y, EMPTY)) {\n    const index = getIndex(x, y)\n    cell.clock = generation\n    cells[index] = cell\n    if (y < upperBound.y) upperBound = { x, y }\n  }\n}\n\nconst update = () => {\n  activeCells = {}\n\n  for (let i = 0, l = cells.length; i < l; i++) {\n    const [x, y] = getCoords(i)\n    const cell = cells[i]\n\n    if (cell.type !== EMPTY) {\n      if (cell.color in activeCells) {\n        activeCells[cell.color].push({ x, y, cell })\n      } else {\n        activeCells[cell.color] = [{ x, y, cell }]\n      }\n    }\n\n    const api = createApi(x, y)\n\n    switch (cell.type) {\n      case sand.NAME:\n        sand.update(api, cell)\n        break\n      case water.NAME:\n        water.update(api, cell)\n        break\n      case smoke.NAME:\n        smoke.update(api, cell)\n        break\n      case fire.NAME:\n        fire.update(api, cell)\n        break\n      case oil.NAME:\n        oil.update(api, cell)\n      case plant.NAME:\n        plant.update(api, cell)\n        break\n    }\n  }\n  generation++\n}\n\nconst getUpperBound = () => upperBound.y\n\nconst refreshUpperBound = () => {\n  if (self.is(upperBound.x, upperBound.y, EMPTY)) {\n    upperBound = defaultUpperBound\n  }\n}\n\nconst getActive = () => activeCells\n\nexport {\n  init,\n  getUpperBound,\n  refreshUpperBound,\n  draw,\n  update,\n  getActive,\n  neighbors,\n}\n","const width = 500\nconst height = 500\nconst cellSize = 5\nconst canvas = document.querySelector('canvas')\nconst ctx = canvas.getContext('2d', { alpha: false })\nconst dpr = window.devicePixelRatio || 1\nconst boundsOffset = 5\n\ncanvas.width = width * dpr\ncanvas.height = height * dpr\ncanvas.style.width = `${width}px`\ncanvas.style.height = `${height}px`\nctx.scale(dpr, dpr)\nctx.fillStyle = 'white'\nctx.fillRect(0, 0, width, height)\n\nconst draw = (world) => {\n  const boundingY = world.getUpperBound() * cellSize - boundsOffset\n\n  ctx.fillStyle = 'white'\n  ctx.fillRect(0, boundingY, width, height - boundingY)\n\n  if (window.DEBUG) {\n    ctx.fillStyle = 'red'\n    ctx.fillRect(0, boundingY, width, 1)\n  }\n\n  const activeCells = world.getActive()\n\n  for (let color in activeCells) {\n    ctx.fillStyle = color\n    const blocks = activeCells[color]\n\n    for (let { x, y } of blocks) {\n      ctx.fillRect(x * cellSize, y * cellSize, cellSize, cellSize)\n    }\n  }\n\n  world.refreshUpperBound()\n}\n\nexport { draw, cellSize }\n","import * as element from '../element'\n\nconst NAME = 'STONE'\n\nconst make = () => element.make({ type: NAME, color: [0, 0, 60, 40] })\n\nexport { NAME, make }\n","import * as sandpit from './sandpit'\nimport * as canvas from './canvas'\nimport * as sand from './elements/sand'\nimport * as stone from './elements/stone'\nimport { empty } from './elements/empty'\nimport * as water from './elements/water'\nimport * as smoke from './elements/smoke'\nimport * as wood from './elements/wood'\nimport * as fire from './elements/fire'\nimport * as oil from './elements/oil'\nimport * as plant from './elements/plant'\n\nwindow.DEBUG = false\nconst MAX_FPS = 60\nlet now, elapsed, then, fpsInterval\n\nconst tick = () => {\n  sandpit.update()\n  canvas.draw(sandpit)\n}\n\nconst loop = () => {\n  requestAnimationFrame(loop)\n  now = Date.now()\n  elapsed = now - then\n\n  if (elapsed > fpsInterval) {\n    then = now - (elapsed % fpsInterval)\n    tick()\n  }\n}\n\nconst start = () => {\n  fpsInterval = 1000 / MAX_FPS\n  then = Date.now()\n\n  loop()\n}\n\nconst $canvas = document.querySelector('#canvas')\n\nlet drawing = false\n\nconst coord = (c) => Math.floor(c / canvas.cellSize)\n\nconst getCoords = (e) => {\n  const x = coord(e.x)\n  const y = coord(e.y)\n\n  return [\n    [x, y],\n    [x + 1, y],\n    [x - 1, y],\n    [x, y + 1],\n    [x, y - 1],\n  ]\n}\n\nconst handleDrawing = (e) => {\n  getCoords(e).forEach((coords) => sandpit.draw(...coords, useElement()))\n}\n\n$canvas.addEventListener('mousemove', (e) => {\n  if (drawing) handleDrawing(e)\n})\n$canvas.addEventListener('click', handleDrawing)\n$canvas.addEventListener('mousedown', () => {\n  drawing = true\n})\n$canvas.addEventListener('mouseup', () => {\n  drawing = false\n})\n\nlet selectedElement = 'sand'\n\nconst stoneBtn = document.querySelector('#pedra-btn')\nconst sandBtn = document.querySelector('#areia-btn')\nconst emptyBtn = document.querySelector('#ar-btn')\nconst waterBtn = document.querySelector('#water-btn')\nconst smokeBtn = document.querySelector('#smoke-btn')\nconst woodBtn = document.querySelector('#wood-btn')\nconst fireBtn = document.querySelector('#fire-btn')\nconst oilBtn = document.querySelector('#oil-btn')\nconst plantBtn = document.querySelector('#plant-btn')\n\nconst elements = {\n  sand,\n  stone,\n  empty: { make: empty },\n  water,\n  smoke,\n  wood,\n  fire,\n  oil,\n  plant,\n}\n\nconst useElement = () => elements[selectedElement].make()\n\nstoneBtn.addEventListener('click', () => {\n  return (selectedElement = 'stone')\n})\n\nsandBtn.addEventListener('click', () => {\n  return (selectedElement = 'sand')\n})\n\nemptyBtn.addEventListener('click', () => {\n  return (selectedElement = 'empty')\n})\n\nwaterBtn.addEventListener('click', () => {\n  return (selectedElement = 'water')\n})\n\nsmokeBtn.addEventListener('click', () => {\n  return (selectedElement = 'smoke')\n})\n\nwoodBtn.addEventListener('click', () => {\n  return (selectedElement = 'wood')\n})\n\nfireBtn.addEventListener('click', () => {\n  return (selectedElement = 'fire')\n})\n\noilBtn.addEventListener('click', () => {\n  return (selectedElement = 'oil')\n})\n\nplantBtn.addEventListener('click', () => {\n  return (selectedElement = 'plant')\n})\n\ndocument.querySelector('#tick').addEventListener('click', tick)\n\nsandpit.init()\n\nif (!window.DEBUG) {\n  start()\n}\n"],"names":["$1460f5c4b71b7c68$export$bc9d46f8a6dad03f","type","clock","$3a032b790485add5$export$8248f9132673e015","args","Math","round","max","min","random","$3a032b790485add5$export$4cdab98efea3e8b2","$3a032b790485add5$export$a5f66370410fab64","values","length","$3a032b790485add5$export$80f8b9c27b5dc2b2","threshold","$3ff9a9a3b6092d14$export$bf41f33ed18406c8","color","meta","colorInput","$3ff9a9a3b6092d14$var$createColor","$3ff9a9a3b6092d14$export$bacc46db4435ba45","cell","$c8ebb0102dacb43d$export$93fca7f496b43a5f","$c8ebb0102dacb43d$export$bf41f33ed18406c8","$474d74fcb62beccd$export$93fca7f496b43a5f","$474d74fcb62beccd$export$bf41f33ed18406c8","direction","$474d74fcb62beccd$export$6854927f027804e4","sandpit","above","get","set","move","is","$e4a4aeb00bd59c81$export$93fca7f496b43a5f","$35ecd7585d8df82f$export$93fca7f496b43a5f","$35ecd7585d8df82f$export$bf41f33ed18406c8","$35ecd7585d8df82f$export$6854927f027804e4","$25b0da8596a9b88a$export$93fca7f496b43a5f","swap","$08eefc0763426e36$export$93fca7f496b43a5f","$08eefc0763426e36$export$bf41f33ed18406c8","energy","$08eefc0763426e36$export$6854927f027804e4","dx","dy","nx","ny","neighbors","$25b0da8596a9b88a$var$orange1","$25b0da8596a9b88a$var$orange2","$25b0da8596a9b88a$var$red1","$25b0da8596a9b88a$var$red2","$25b0da8596a9b88a$var$red3","$25b0da8596a9b88a$export$bf41f33ed18406c8","phase","$25b0da8596a9b88a$export$6854927f027804e4","igniteTarget","$25b0da8596a9b88a$var$ignite","spreadChance","burnTarget","$25b0da8596a9b88a$var$burn","noNeighbors","$e4a4aeb00bd59c81$export$bf41f33ed18406c8","$e4a4aeb00bd59c81$export$6854927f027804e4","$65c2d75c41e187d5$export$93fca7f496b43a5f","$65c2d75c41e187d5$export$bf41f33ed18406c8","$65c2d75c41e187d5$export$6854927f027804e4","below","$e1cd449f27ef3d0e$var$generation","$e1cd449f27ef3d0e$var$upperBound","$e1cd449f27ef3d0e$var$defaultUpperBound","$e1cd449f27ef3d0e$var$activeCells","$e1cd449f27ef3d0e$var$cells","$e1cd449f27ef3d0e$var$size","$e1cd449f27ef3d0e$export$8e9f59652b1cad73","newSize","x","y","Array","from","$e1cd449f27ef3d0e$var$get","$e1cd449f27ef3d0e$var$getIndex","$e1cd449f27ef3d0e$var$set","index","$e1cd449f27ef3d0e$export$1bf6aec5ccd78699","range","_","i","n","flat","$e1cd449f27ef3d0e$var$createApi","cx","cy","c0","c1","$e1cd449f27ef3d0e$var$self","$e1cd449f27ef3d0e$var$getCoords","$e1cd449f27ef3d0e$export$7cbbc9db17e8ab1b","$e1cd449f27ef3d0e$export$6854927f027804e4","l","push","api","$e1cd449f27ef3d0e$export$7fd58492dd0d1e64","$e1cd449f27ef3d0e$export$66f1f77d419e5f9a","$e1cd449f27ef3d0e$export$5ccc10bf06e37b76","$5065ffdfbfb3c90c$var$canvas","document","querySelector","$5065ffdfbfb3c90c$var$ctx","getContext","alpha","$5065ffdfbfb3c90c$var$dpr","window","devicePixelRatio","width","height","style","scale","fillStyle","fillRect","$4a3193ef63973c15$export$93fca7f496b43a5f","$4a3193ef63973c15$export$bf41f33ed18406c8","DEBUG","$379cc73f66e6620c$var$now","$379cc73f66e6620c$var$elapsed","$379cc73f66e6620c$var$then","$379cc73f66e6620c$var$fpsInterval","$379cc73f66e6620c$var$tick","$e1cd449f27ef3d0e$exports","update","world","boundingY","getUpperBound","activeCells","getActive","blocks","refreshUpperBound","$5065ffdfbfb3c90c$export$7cbbc9db17e8ab1b","$379cc73f66e6620c$var$loop","requestAnimationFrame","Date","now","$379cc73f66e6620c$var$$canvas","$379cc73f66e6620c$var$drawing","$379cc73f66e6620c$var$coord","c","floor","$379cc73f66e6620c$var$handleDrawing","e","$379cc73f66e6620c$var$getCoords","forEach","coords","draw","$379cc73f66e6620c$var$useElement","addEventListener","$379cc73f66e6620c$var$selectedElement","$379cc73f66e6620c$var$stoneBtn","$379cc73f66e6620c$var$sandBtn","$379cc73f66e6620c$var$emptyBtn","$379cc73f66e6620c$var$waterBtn","$379cc73f66e6620c$var$smokeBtn","$379cc73f66e6620c$var$woodBtn","$379cc73f66e6620c$var$fireBtn","$379cc73f66e6620c$var$oilBtn","$379cc73f66e6620c$var$plantBtn","$379cc73f66e6620c$var$elements","$65c2d75c41e187d5$exports","$4a3193ef63973c15$exports","empty","make","$e4a4aeb00bd59c81$exports","$474d74fcb62beccd$exports","$c8ebb0102dacb43d$exports","$25b0da8596a9b88a$exports","$35ecd7585d8df82f$exports","$08eefc0763426e36$exports","init"],"version":3,"file":"index.0b404c58.js.map"}