function e(e,t,o,c){Object.defineProperty(e,t,{get:o,set:c,enumerable:!0,configurable:!0})}var t={};e(t,"getActive",(()=>ie)),e(t,"getUpperBound",(()=>ce)),e(t,"neighbors",(()=>V)),e(t,"draw",(()=>te)),e(t,"update",(()=>oe)),e(t,"init",(()=>H)),e(t,"refreshUpperBound",(()=>re));var o={};e(o,"NAME",(()=>I)),e(o,"update",(()=>G)),e(o,"make",(()=>z));const c=()=>({type:"EMPTY",clock:0});var r={};e(r,"update",(()=>R)),e(r,"make",(()=>O)),e(r,"NAME",(()=>U));const i=(...e)=>Math.round(((e,t=0)=>Math.random()*(e-t)+t)(...e)),n=e=>e[i(e.length-1,0)],s=e=>Math.random()<e,a=({type:e,color:t,...o})=>({type:e,clock:0,colorInput:t,color:l(t),...o}),l=e=>`hsl(${e[0]}deg ${e[1]}% ${i(e[2],e[3])}%)`,d=e=>{e.color=l(e.colorInput)};var p={};e(p,"NAME",(()=>S)),e(p,"make",(()=>B)),e(p,"update",(()=>D));var y={};e(y,"NAME",(()=>E)),e(y,"make",(()=>k));const E="WOOD",k=()=>a({type:E,color:[33,41,30,15]});var m={};e(m,"update",(()=>M)),e(m,"NAME",(()=>u)),e(m,"make",(()=>v));const u="SMOKE",v=()=>a({type:u,direction:n([1,-1]),color:[4,2,79,90]}),M=(e,t)=>{const o=e.get(0,-1);switch(s(.015)&&e.set(0,0,{type:"EMPTY",clock:0}),o.type){case"EMPTY":s(.95)?e.move(0,-1):e.is(t.direction,1,"EMPTY")&&e.move(t.direction,-1);break;case U:e.move(0,-1)}s(.5)&&e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):t.direction*=-1};var f={};e(f,"NAME",(()=>b)),e(f,"make",(()=>h)),e(f,"update",(()=>w));const b="OIL",h=()=>a({type:b,direction:n([1,-1]),color:[25,59,41,48]}),w=(e,t)=>{switch(e.get(0,1).type){case S:case"EMPTY":e.move(0,1);break;case b:e.is(t.direction,1,"EMPTY")&&e.move(t.direction,1);break;case U:e.is(t.direction,-1,U)&&e.swap(t.direction,-1)}e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):s(.5)&&e.is(t.direction,0,U)?e.swap(t.direction,0):t.direction*=-1,s(.005)&&d(t)};var P={};e(P,"make",(()=>g)),e(P,"update",(()=>Y)),e(P,"NAME",(()=>T));const T="PLANT",g=(e,t=[122,73,36,30])=>{const o=s(.1);return a({type:T,kind:o?"stem":"bud",energy:void 0!==e?e:o?i(10,15):i(1,5),direction:[n([1,0,-1]),-1],color:t})},Y=(e,t)=>{const[o,c]=t.direction;e.is(o,c,"EMPTY")&&s(.2)&&t.energy>0&&(t.energy--,e.set(o,c,g(t.energy)));for(let[r,i]of e.neighbors(1))s(.05)&&e.is(r,i,U)&&(e.set(r,i,{type:"EMPTY",clock:0}),e.set(o,c,g(t.energy)))},S="FIRE",A=[35,76,62,72],L=[35,79,67,77],q=[7,82,56,66],x=[7,82,49,59],N=[7,87,33,43],B=(e="spark")=>a({type:S,phase:e,direction:n([1,-1]),color:n([A,L,q,x,N])}),D=(e,t)=>{switch(t.phase){case"spark":s(.2)&&e.set(0,0,{type:"EMPTY",clock:0}),s(.73)&&e.is(0,-1,"EMPTY")?e.move(0,-1):e.is(t.direction,-1,"EMPTY")&&e.move(t.direction,-1),s(.75)&&e.is(t.direction,0,"EMPTY")?e.move(t.direction,0):t.direction*=-1,(e=>{let t;for(let[o,c]of e.neighbors(1))if(s(1)&&(e.is(o,c,E)||e.is(o,c,b)||e.is(o,c,T))){t=[o,c];break}t&&(e.set(...t,B("blaze")),e.set(0,0,{type:"EMPTY",clock:0}))})(e);break;case"blaze":if(((e,t)=>{let o;for(let[c,r]of e.neighbors(2))if(s(t)&&(e.is(c,r,E)||e.is(c,r,b)||e.is(c,r,T))){o=[c,r];break}o&&e.set(...o,B("blaze"))})(e,.01),s(.01))return void e.set(0,0,v());e.is(0,-1,"EMPTY")&&(s(.06)?e.set(0,-1,B()):s(.15)&&e.set(0,-1,v()));let o=!0;for(let[t,c]of e.neighbors(1))if(!e.is(t,c,"EMPTY")){o=!1;break}o&&e.set(0,0,{type:"EMPTY",clock:0})}},U="WATER",O=()=>a({type:U,direction:n([1,-1]),color:[216,65,60,50]}),R=(e,t)=>{switch(e.get(0,1).type){case S:case"EMPTY":e.move(0,1);break;case b:e.swap(0,1);break;case U:e.is(t.direction,1,"EMPTY")&&e.move(t.direction,1)}e.is(t.direction,0,"EMPTY")||e.is(t.direction,0,S)?e.move(t.direction,0):t.direction*=-1,s(.005)&&d(t)},I="SAND",z=()=>a({type:I,color:[46,78,75,50]}),G=e=>{const t=e.get(0,1),o=n([1,-1]);switch(t.type){case"EMPTY":e.move(0,1);break;case b:case U:e.swap(0,1);break;case I:e.is(o,1,"EMPTY")&&e.move(o,1)}};let $,F,W,j,C=[],K=0;const H=(e=100)=>{$=1,W={x:0,y:e},F=W,K=e,C=Array.from({length:K*K},(()=>({type:"EMPTY",clock:0})))},J=(e,t)=>e<0||t<0||e>=K||t>=K?{type:"BOUNDS"}:C[_(e,t)],Q=(e,t,o={type:"EMPTY",clock:0})=>{const c=_(e,t);o.clock=$+1,C[c]=o,t<F.y&&(F={x:e,y:t})},V=(e=1)=>Array.from({length:e},((e,t)=>{const o=t+1;return[[-1*o,-1*o],[-1*o,0],[-1*o,1*o],[0,-1*o],[0,1*o],[1*o,-1*o],[1*o,0],[1*o,1*o]]})).flat(),X=(e,t)=>({is:(o,c,r)=>J(e+o,t+c).type===r,move:(o,c)=>{const r=J(e,t);r.clock>$||(Q(e+o,t+c,r),Q(e,t,{type:"EMPTY",clock:0}))},swap:(o,c)=>{const r=J(e,t);if(r.clock>$)return;const i=e+o,n=t+c,s=J(i,n);Q(i,n,r),Q(e,t,s)},set:(o,c,r)=>Q(e+o,t+c,r),get:(o,c)=>J(e+o,t+c),neighbors:V}),Z=X(0,0),_=(e,t)=>e*K+t,ee=e=>{const t=e%K;return[(e-t)/K,t]},te=(e,t,o)=>{if("EMPTY"===o.type||Z.is(e,t,"EMPTY")){const c=_(e,t);o.clock=$,C[c]=o,t<F.y&&(F={x:e,y:t})}},oe=()=>{j={};for(let e=0,t=C.length;e<t;e++){const[t,o]=ee(e),c=C[e];"EMPTY"!==c.type&&(c.color in j?j[c.color].push({x:t,y:o,cell:c}):j[c.color]=[{x:t,y:o,cell:c}]);const r=X(t,o);switch(c.type){case I:G(r,c);break;case U:R(r,c);break;case u:M(r,c);break;case S:D(r,c);break;case b:w(r,c);break;case T:Y(r,c)}}$++},ce=()=>F.y,re=()=>{Z.is(F.x,F.y,"EMPTY")&&(F=W)},ie=()=>j,ne=document.querySelector("canvas"),se=ne.getContext("2d",{alpha:!1}),ae=window.devicePixelRatio||1;ne.width=500*ae,ne.height=500*ae,ne.style.width="500px",ne.style.height="500px",se.scale(ae,ae),se.fillStyle="white",se.fillRect(0,0,500,500);var le={};e(le,"NAME",(()=>de)),e(le,"make",(()=>pe));const de="STONE",pe=()=>a({type:de,color:[0,0,60,40]});window.DEBUG=!1;let ye,Ee,ke,me;const ue=()=>{t.update(),(e=>{const t=5*e.getUpperBound()-5;se.fillStyle="white",se.fillRect(0,t,500,500-t),window.DEBUG&&(se.fillStyle="red",se.fillRect(0,t,500,1));const o=e.getActive();for(let e in o){se.fillStyle=e;const t=o[e];for(let{x:e,y:o}of t)se.fillRect(5*e,5*o,5,5)}e.refreshUpperBound()})(t)},ve=()=>{requestAnimationFrame(ve),ye=Date.now(),Ee=ye-ke,Ee>me&&(ke=ye-Ee%me,ue())},Me=document.querySelector("#canvas");let fe=!1;const be=e=>Math.floor(e/5),he=e=>{(e=>{const t=be(e.x),o=be(e.y);return[[t,o],[t+1,o],[t-1,o],[t,o+1],[t,o-1]]})(e).forEach((e=>t.draw(...e,Be())))};Me.addEventListener("mousemove",(e=>{fe&&he(e)})),Me.addEventListener("click",he),Me.addEventListener("mousedown",(()=>{fe=!0})),Me.addEventListener("mouseup",(()=>{fe=!1}));let we="sand";const Pe=document.querySelector("#pedra-btn"),Te=document.querySelector("#areia-btn"),ge=document.querySelector("#ar-btn"),Ye=document.querySelector("#water-btn"),Se=document.querySelector("#smoke-btn"),Ae=document.querySelector("#wood-btn"),Le=document.querySelector("#fire-btn"),qe=document.querySelector("#oil-btn"),xe=document.querySelector("#plant-btn"),Ne={sand:o,stone:le,empty:{make:c},water:r,smoke:m,wood:y,fire:p,oil:f,plant:P},Be=()=>Ne[we].make();Pe.addEventListener("click",(()=>we="stone")),Te.addEventListener("click",(()=>we="sand")),ge.addEventListener("click",(()=>we="empty")),Ye.addEventListener("click",(()=>we="water")),Se.addEventListener("click",(()=>we="smoke")),Ae.addEventListener("click",(()=>we="wood")),Le.addEventListener("click",(()=>we="fire")),qe.addEventListener("click",(()=>we="oil")),xe.addEventListener("click",(()=>we="plant")),document.querySelector("#tick").addEventListener("click",ue),t.init(),window.DEBUG||(me=1e3/60,ke=Date.now(),ve());
//# sourceMappingURL=index.40de1b65.js.map
